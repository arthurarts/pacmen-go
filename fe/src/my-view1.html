<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/google-map/google-map.html">
<link rel="import" href="../bower_components/google-map/google-map-directions.html">
<link rel="import" href="../bower_components/google-map/google-map-marker.html">
<link rel="import" href="../bower_components/google-map/google-map-poly.html">
<link rel="import" href="../bower_components/google-map/google-map-point.html">
<link rel="import" href="../bower_components/geo-location/geo-location.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">

<link rel="import" href="shared-styles.html">

<dom-module id="my-view1">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }

      .map {
        width: 100%;
        height: 100%;
      }

      google-map {
        margin: 0;
        height: 88vh;
      }
    </style>

    <div class="map">

      <iron-ajax
              auto
              url="data/markers.json"
              handle-as="json"
              on-response="handleResponse"
              method="GET"
      ></iron-ajax>

      <google-map-search map="[[map]]" query="Pizza" results="{{results}}">
      </google-map-search>

      <google-map-directions map="{{map}}"
                             api-key="AIzaSyDaGvdEig57JDplmrPiGsFv9saI9vO959g"
                             start-address="rotterdam"
                             end-address="amsterdam"
                             travel-mode="WALKING"
                             waypoints='[{"location": "rotterdam"}, {"location": "amsterdam"}]'></google-map-directions>

      <google-map map="{{map}}" latitude="51.91667" longitude="4.5" api-key="AIzaSyDaGvdEig57JDplmrPiGsFv9saI9vO959g">

        <google-map-marker latitude="{{latitude}}" longitude="{{longitude}}"
                           title="Pacmen Go!" draggable="true" animation="DROP"></google-map-marker>

        <template is="dom-repeat" items="{{markers}}" as="marker">
          <google-map-marker latitude="{{marker.latitude}}" longitude="{{marker.longitude}}">
            <p>{{marker.label}}</p>
            <span><b>{{marker.title}}</b><br>
            {{marker.formatted_address}}<br><img src="{{marker.image}}"/></span>

          </google-map-marker>
        </template>

      </google-map>

      <geo-location latitude="{{latitude}}" longitude="{{longitude}}"></geo-location>
    </div>

  </template>

  <script>
    class MyView1 extends Polymer.Element {
      static get is() {
        return 'my-view1';
      }

      static get properties() {
        return {
          latitude: {
            type: Number,
            notify: true,
            value: 51.81667

                },
                map: Object,

                longitude: {
                    type: Number,
                    notify: true,
                    value: 4.4
                },
                markers: Object,
            }
        }

      ready() {
        this.addEventListener('google-map-marker-click', this.markerClicked);
        super.ready();
      }

        markerClicked(events) {
            console.log(events);
        }

        handleResponse(event) {
            this.markers = event.detail.response.markers;
          console.log(this.markers)
        }

    }
    window.customElements.define(MyView1.is, MyView1);
  </script>
</dom-module>
